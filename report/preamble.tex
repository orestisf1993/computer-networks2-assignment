%~ xelatex -ini -shell-escape -job-name="preamble" "&xelatex preamble.tex\dump"
\RequirePackage[l2tabu, orthodox]{nag}
% Specify the type of document
\documentclass[a4paper]{report}

% packages
% Argument 'table' for '\cellcolor{}' command.
% Should be high because it might get loaded by another package with different arguments:
% - http://tex.stackexchange.com/questions/87197/latex-error-option-clash-for-package-xcolor-for-table
% - http://tex.stackexchange.com/questions/83101/option-clash-for-package-xcolor
\usepackage[usenames, table]{xcolor}

% https://foss.ntua.gr/wiki/index.php/%CE%95%CE%BB%CE%BB%CE%B7%CE%BD%CE%B9%CE%BA%CE%B1_%CF%83%CF%84%CE%BF_TeX/LaTeX_%CE%BC%CE%B5_%CF%84%CE%BF_XeTeX#.CE.97yphenation
% title in pic:
\usepackage{titlepic}
\usepackage{tikz}
\usepackage[a4paper, margin=1.0in, bottom=1.5in]{geometry}

% Select alternative section titles
% https://www.ctan.org/pkg/titlesec
\usepackage{titlesec}

% For graphics.
% http://www.kwasan.kyoto-u.ac.jp/solarb6/usinggraphicx.pdf
% https://ctan.org/pkg/graphicx
\usepackage{graphicx}

% provides LaTeX the ability to create hyperlinks within the document.
% https://www.ctan.org/pkg/hyperref
% http://en.wikibooks.org/wiki/LaTeX/Hyperlinks#Hyperref
\usepackage[bookmarks=true,colorlinks=true,linkcolor=blue]{hyperref}
% for going to the top of an image when a figure reference is clicked: http://stackoverflow.com/a/21251925/3430986%
\usepackage{caption}
% http://tex.stackexchange.com/questions/118713/is-microtype-fully-supported-now-by-xelatex-if-not-how-can-i-keep-myself-up-to
% http://tug.org/pipermail/xetex/2013-April/024263.html
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{fancyref}

\titleformat{\chapter}[hang]{\bfseries\huge}{\thechapter}{2pc}{}
% plain, headings or empty. Headins prints the current chapter heading + page number
%\pagestyle{headings}
% fancier headings with these package
\usepackage{fancyhdr}
\pagestyle{fancy}
% with this we ensure that the chapter and section
% headings are in lowercase.
\renewcommand{\chaptermark}[1]{%
  \markboth{#1}{}}
\renewcommand{\sectionmark}[1]{%
  \markright{\thesection\ #1}}
\fancyhf{} % delete current header and footer
% Warning: using fancyhead and minted section names will result in tex capacity errors.
\fancyhead[L]{\emph{Δίκτυα Υπολογιστών II}\\\bfseries\leftmark}
\fancyhead[R]{\emph{Ορέστης Φλώρος-Μαλιβίτσης 7796}\\\bfseries\rightmark}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0pt}
\addtolength{\headheight}{0.5pt} % space for the rule
\fancypagestyle{plain}{%
  \fancyhead{} % get rid of headers on plain pages
  \renewcommand{\headrulewidth}{0pt} % and the line
}

% http://ctan.org/pkg/enumerate
\usepackage{enumerate}
% http://tex.stackexchange.com/a/56953/78791
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
% http://tex.stackexchange.com/a/107190/78791
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
% bad fonts for implies?
\renewcommand{\implies}{=\!\Rightarrow}
\usepackage{extarrows}

\usepackage{multirow}
\usepackage{placeins}
\usepackage{etoolbox}
\usepackage{booktabs}
\setcounter{tocdepth}{3} % subsub has numbers
\setcounter{secnumdepth}{3} % subsub in toc

\usepackage{adjustbox}  % for maxsizebox: http://stackoverflow.com/a/29143366/3430986
\usepackage{float}  % for figure H.

% Number specific equation in align*
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

% Disable par indents:
% http://tex.stackexchange.com/a/55016/78791
% http://ctan.org/pkg/parskip
\usepackage{parskip}

% For logo in footer.
\usepackage[all]{background}
\usepackage{lastpage}
\newcommand\activateBG{%
\backgroundsetup{
  scale=1,
  color=black,
  opacity=1,
  angle=0,
  position=current page.south,
  vshift=60pt,
  contents={%
  \small\sffamily%
  \begin{minipage}{.8\textwidth}
  \parbox[b]{.6\textwidth}{%
  Σελίδα \thepage\ από \pageref{LastPage}}\hfill
  \textcolor{red}{\rule{\textwidth}{1.5pt}}
  \end{minipage}\hspace{.02\textwidth}%
  \begin{minipage}{.18\textwidth}
  \includegraphics[width=\linewidth,height=2cm,keepaspectratio]{images/university}
  \end{minipage}%
  }
}%
}
\newcommand\deactivateBG{\backgroundsetup{contents={}}}

% Quick image refs:
\newcommand{\imageref}[1] {%
\hyperref[fig:#1]{\figurename{} \ref{fig:#1}}}
\newcommand{\imagerefc}[2] {%
\hyperref[fig:#1]{fig:#2}}

% Bibliography:
\usepackage[numbers, sort]{natbib}
\bibliographystyle{plain}

% Used for better handling of multi-line rows on tables.
\usepackage{tabularx}

% For quotations.
\usepackage{csquotes}

% Code listings:
%
% https://github.com/HiSPARC/infopakket/issues/27#issuecomment-134511920
% http://tex.stackexchange.com/questions/165929/semiverbatim-with-tikz-in-beamer
\makeatletter
\global\let\tikz@ensure@dollar@catcode=\relax
\makeatother
\newenvironment{code}{\captionsetup{type=listing}}{}
\usepackage[newfloat=true]{minted}
\setminted{%
autogobble=true,
breaklines=true,
frame=single,
linenos=false}
